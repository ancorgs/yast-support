// testedfiles: supportio.ycp

{

    include "testsuite.ycp";

    include "support/supportio.ycp";

    map READ_ok_key =
    $[ "target":
        $[ "stat":
           $[ "size": 227]
        ],
       "support":
		$[ "key":
            $[ "KEY_NAME1": "Washington",
               "KEY_NAME2": "Irwing",
               "KEY_SALUTATION": "male",
               "KEY_COMPANY": "",
               "KEY_STREET": "",
               "KEY_ZIP": "",
               "KEY_COUNTRY": "",
               "KEY_STATE": "",
               "KEY_CITY": "",
               "KEY_EMAIL": "wi@iw.jh",
               "KEY_CODE": "WI-CATCH22-Yo-Yo"
            ]
        ]
	];

    map READ_ok_nokey =
    $[ "target":
        $[ "stat": $[]
        ],
       "support":
		$[ "key":
            $[ "KEY_NAME1": "",
               "KEY_NAME2": "",
               "KEY_SALUTATION": "",
               "KEY_COMPANY": "",
               "KEY_STREET": "",
               "KEY_ZIP": "",
               "KEY_COUNTRY": "",
               "KEY_STATE": "",
               "KEY_CITY": "",
               "KEY_EMAIL": "",
               "KEY_CODE": ""
            ]
        ]
	];

    map EX_ok =
    $[ "target":
        $[ "mkdir": true,
           "bash": 0
        ]
    ];

    map READ_nil_nokey =
    $[ "target":
        $[ "stat": $[]
        ],
       "support":
		$[ "key": nil ]
	];

    map EX_notok =
    $[ "target":
        $[ "mkdir": true,
           "bash": 1
        ]
    ];

    // keydata file present at usual place
	TEST (``(read_supportkey()), [ READ_ok_key, $[], $[] ], nil);
    DUMP ("----------------------");

    // keydata file not present, but successfully copied from template
	TEST (``(read_supportkey()), [ READ_ok_nokey, $[], EX_ok ], nil);
    DUMP ("----------------------");

    // keydata file cannot be copied and nil data will be read
	TEST (``(read_supportkey()), [ READ_nil_nokey, $[], EX_notok ], nil);

}
